<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<!-- 
    1. 同源策略
        * 同源策略是浏览器的一种安全策略
        * 同源是指 协议、域名、端口号必须完全相同
        * 有一个不同就是跨域

    2. 解决跨域问题
        2.1 JSONP(程序员)----只支持get请求
            * 在网页上有一些标签天生具有跨域能力， 比如： img link iframe script。
            * JSONP 就是利用 script 标签的跨域能力来发送请求的
        2.2 CORS(官方)

    3. JSONP的使用
        3.1 动态的创建一个 script 标签
            let script = document.createElement("script");
        3.2 设置 script 的 src， 设置回调函数
            script.src = "http://localhost:3000/testAJAX?callback=abc";
            function abc(data) {
                console.log(data.name);
            };
        3.3 将 script 添加到 body 中
            document.body.appendChild(script);
        3.4 服务器中路由的处理
            router.get("/testAJAX" , function (req , res) {
                console.log("收到请求");
                var callback = req.query.callback;
                var obj = {
                    name:"孙悟空",
                    age:18
                    } 
                    res.send(callback+"("+JSON.stringify(obj)+")");
                });
        6. 重点是JSNOP返回的是一个经过函数包包装的数据，也就是返回的是一个函数，函数的实参是ajax请求的结果
    
    4. CORS
        * CORS（Cross-Origin Resource Sharing） ， 跨域资源共享
        * CORS 是官方的跨域解决方案
        * 它的特点是不需要在客户端做任何特殊的操作，完全在服务器中进行处理
        * 支持get和post请求  
        * 跨域资源共享标准新增了一组 HTTP首部字段，允许服务器声明哪些源站通过浏览器有权限访问哪些资源

        4.1 CORS 怎么工作的？
            * CORS是通过设置一个响应头来告诉浏览器，该请求允许跨域，浏览器收到该响应以后就会对响应放行
        4.2 CORS 的使用
            主要是服务器端的设置：
            app.get("/testAJAX" , function (req , res) {
                //通过 res 来设置响应头， 来允许跨域请求
                res.set("Access-Control-Allow-Origin","*");
                // 允许自定义响应头
                response.setHeader("Access-Control-Allow-Headers", '*');
                // 允许所有请求方法
                response.setHeader("Access-Control-Allow-Method", '*');
                res.send("testAJAX 返回的响应");
                });
 -->
</body>
</html>